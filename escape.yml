name: escape-inventory
version: '0.12.@'
description: "A Go build for the Escape Inventory"
logo: logo.png

depends:
- escape-core-latest as core

includes: 
- escape-inventory
- LICENSE
- Makefile
- README.md
- "*.go"
- cmd/
- config/
- dao/
- deps/
- docs/
- handlers/
- metrics/
- model/
- storage/
- vendor/

metadata:
  release_metadata_api_version: $core.metadata.release_metadata_api_version

post_build: scripts/build.sh
test: scripts/test.sh

errands:
  upload_to_gcs:
    description: "Upload the produced linux/amd64 binary to a GCS bucket"
    script: scripts/upload_to_gcs.sh
    inputs:
    - id: bucket
      description: "The target bucket"
    - id: credentials
      description: "Service account credentials"
    - id: inventory_version
      default: $this.version
  publish_binaries:
    description: Create binaries for all platforms and upload to a GCS bucket
    inputs:
    - id: bucket
      description: "The target bucket"
    - id: credentials
      description: "Service account credentials"
    - id: inventory_version
      default: $this.version
    script: scripts/publish-binaries.sh

templates:
- cmd/metadata.go.tpl
